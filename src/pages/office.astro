---
import Layout from "../layouts/Layout.astro";
import PageFooter from "../components/PageFooter.astro";
import Header from "../components/Header.astro";
import Image from "astro/components/Image.astro";
import OfficeBgImg from "../assets/images/office.png";
import OfficeImg1 from "../assets/images/office-1.png";
import OfficeImg2 from "../assets/images/office-2.png";
import OfficeImg3 from "../assets/images/office-3.png";
import OfficeImg4 from "../assets/images/office-4.png";
import OfficeImg5 from "../assets/images/office-5.png";
import OfficeImg6 from "../assets/images/office-6.png";
import OfficeImg7 from "../assets/images/office-7.png";
import OfficeImg8 from "../assets/images/office-8.png";
import OfficeImg9 from "../assets/images/office-9.png";
import OfficeImg10 from "../assets/images/office-10.png";
---

<Layout
  title="OFFICE |KOHEI HARADA"
  keywords="KOHEIHARADA, Project Design, Creative, Note Drop, Design Office"
  descr="A design office that handles everything from the ideation of new business ventures to project design and creative direction. We are committed to designing user behaviors with a focus on the future of DAOs (Decentralized Autonomous Organizations)."
>
  <Header />
  <span class="kh">(C)KOHEI HARADA</span>
  <section class="office">
    <div class="office__top">
      <video
        src="/video/office-video.mp4"
        autoplay
        loop
        muted
        class:list={"office-top__media"}></video>
    </div>
    <div class="office__map">
      <div class="office__map-info">
        <div class="office__map-info-content">
          <b class="office__map-info-title font-title">OFFICE</b>
          <p class="office__map-info-descr font-text-content">
            Insulindestraat 78 3038 JB Rotterdam, Netherlands
          </p>
        </div>
      </div>
      <iframe
        class="office__map-iframe"
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2459.931720161329!2d4.466096176750145!3d51.93519897936146!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47c434ad14a923a9%3A0xc853e7edb64e95e0!2zSW5zdWxpbmRlc3RyYWF0IDc4LCAzMDM4IEpCIFJvdHRlcmRhbSwg0J3QuNC00LXRgNC70LDQvdC00Ys!5e0!3m2!1sru!2sjp!4v1736492759886!5m2!1sru!2sjp"
        width="600"
        height="450"
        style="border:0;"
        allowfullscreen=""
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
    <div class="gallery-pin-conatiner">
      <div class="gallery-pin-conatiner__progress"></div>
      <div class="gallery-wrap">
        <div class="gallery__container">
          <article class="article gallery desktop">
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg1}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg2}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg3}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg4}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg5}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg6}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg7}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg8}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg9}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
            <div class="gallery__item">
              <div class="gallery__inner">
                <Image
                  src={OfficeImg10}
                  width={1280}
                  height={800}
                  alt="Office"
                  class:list={"gallery__img desktop"}
                />
              </div>
            </div>
          </article>
        </div>
      </div>
    </div>
  </section>
  <style lang="scss">
    .kh {
      position: fixed;
      font-size: 8px;
      bottom: 14px;
      left: 16px;
      z-index: 1000;
    }
    .office {
      display: flex;
      flex-direction: column;
      &__top {
        width: 100%;
        height: 100vh;
        display: flex;
        &-media {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
      }
      &__map {
        height: 100vh;
        display: flex;
        align-items: center;
        width: 100%;
        margin-bottom: 100px;
        // max-width: 1280px;
        margin-inline: auto;
        justify-content: center;
        &-info {
          display: flex;
          margin-right: 90px;
          width: 40%;
          max-width: 600px;
          align-items: flex-end;
          text-align: left;
          &-content {
            max-width: 600px;
            padding-left: 80px;
            flex-grow: 1;
          }
          &-title {
            text-transform: uppercase;
            font-size: 54px;
            line-height: 54px;
            margin-bottom: 11px;
          }
          &-descr {
            font-size: 16px;
            line-height: 24px;
          }
        }
        &-iframe {
          height: 100%;
          filter: grayscale(0.8);
          flex-grow: 2;
        }
      }
    }

    .gallery {
      padding: 0;
    }
    .gallery-pin-container {
      /* overflow: hidden; */
    }
    .gallery-pin-conatiner__progress {
      position: fixed;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 4px;
      background-color: rgba(1, 1, 1, 1);
      transform: translateX(-100%);
      transition: 0.4s opacity;
    }
    .gallery-pin-conatiner__progress--hidden {
      opacity: 0;
      pointer-events: none;
    }
    .gallery:not(:last-child) {
      margin-bottom: 64px;
    }
    .gallery__item {
      position: absolute;
    }
    .gallery__img {
      width: 100%;
      height: 100%;
    }
    .content__inner {
      display: flex;
      flex-direction: column;
    }
    .gallery {
      min-height: 100%;
      position: absolute;
      display: flex;
      flex-direction: column;
      top: 0;
      border-radius: 0;
      width: 100%;
      align-items: center;
    }
    .gallery-wrap {
      height: 500vh;
    }
    .gallery .gallery__item:first-child {
      z-index: 10;
    }
    .gallery .gallery__item:nth-child(2) {
      z-index: 9;
    }
    .gallery .gallery__item:nth-child(3) {
      z-index: 8;
    }
    .gallery .gallery__item:nth-child(4) {
      z-index: 7;
    }
    .gallery .gallery__item:nth-child(5) {
      z-index: 6;
    }
    .gallery .gallery__item:nth-child(6) {
      z-index: 5;
    }
    .gallery .gallery__item:nth-child(7) {
      z-index: 4;
    }
    .gallery .gallery__item:nth-child(8) {
      z-index: 3;
    }
    .gallery .gallery__item:nth-child(9) {
      z-index: 2;
    }
    .gallery .gallery__item:last-child {
      z-index: 1;
    }
    .gallery__container {
      margin-inline: auto;
      height: calc(100vh - 180px);
      overflow-y: hidden;
      display: flex;
      flex-direction: column;
      position: relative;
      margin-inline: 119px;
      position: sticky;
      top: 90px;
    }
    .gallery__item {
      min-height: 100%;
      min-height: 100%;
      width: fit-content;
      height: 100%;
      flex-grow: 2;
      display: flex;
      background-color: transparent;
      will-change: filter;
    }
    .gallery__inner {
      min-height: 100%;
      width: auto;
      display: flex;
    }
    .gallery__inner picture {
      width: 100%;
    }
    .gallery__img {
      object-fit: contain;
    }
    @media (max-width: 767.9px) {
      .office {
        &__map {
          flex-direction: column;
          margin-bottom: 60px;
          &-info {
            width: 100%;
            margin-right: 0;
            &-content {
              padding-left: 44px;
              padding-top: 149px;
              padding-bottom: 80px;
            }
          }
          &-iframe {
            width: 100%;
          }
        }
      }
      .gallery-wrap {
        height: auto;
      }
      .gallery-pin-conatiner {
        &__progress {
          display: none;
        }
      }
      .gallery {
        position: static;
        row-gap: 20px;
        margin-bottom: 200px;
        &__container {
          height: auto;
          position: static;
          margin-inline: 0;
        }
        &__item {
          position: static;
        }
      }
    }
  </style>
  <script>
    import gsap from "gsap";
    import ScrollTrigger from "gsap/ScrollTrigger";
    gsap.registerPlugin(ScrollTrigger);
    document.addEventListener("DOMContentLoaded", function (event) {
      const officeVideo = document.querySelector(".office-top__media");
      officeVideo.play();

      ScrollTrigger.matchMedia({
        "(min-width: 768px)": function () {
          console.log(10);

          gsap.set(".gallery .gallery__item:not(:last-child)", {
            filter: "brightness(1)",
          });
          const clipAnimation = gsap.to(
            ".gallery .gallery__item:not(:last-child)",
            {
              clipPath() {
                return "inset(0 0 100% 0)";
              },
              filter: "brightness(0)",
              stagger: 0.5,
            }
          );
          const items = Array.from(document.querySelectorAll(".slider__item"));
          ScrollTrigger.create({
            trigger: ".gallery-wrap",
            start: "top top",
            end: "bottom bottom",
            animation: clipAnimation,
            scrub: 2,
          });
          gsap.to(".gallery-pin-conatiner__progress", {
            x: 0,
            scrollTrigger: {
              trigger: ".gallery-pin-conatiner",
              start: "top top",
              end: "bottom bottom",
              stagger: 0.5,
              scrub: 2,
              onUpdate: (self) => {
                const progress = self.progress;
                if (progress === 1 || progress === 0) {
                  document
                    .querySelector(".gallery-pin-conatiner__progress")
                    .classList.add("gallery-pin-conatiner__progress--hidden");
                } else {
                  document
                    .querySelector(".gallery-pin-conatiner__progress")
                    .classList.remove(
                      "gallery-pin-conatiner__progress--hidden"
                    );
                }
              },
            },
          });
        },
        "(max-width: 767.9px)": function () {
          const galleryItems = document.querySelectorAll(".gallery__item");
          galleryItems.forEach((item, index) => {
            const nextItem = galleryItems[index + 1];

            // Анимация выезда следующего элемента
            if (index > 0) {
              gsap.fromTo(
                item,
                {
                  opacity: 0,
                  y: "-100%",
                  clipPath: "polygon(0 0, 100% 0, 100% 0, 0 0)",
                },
                {
                  clipPath: "polygon(0 0, 100% 0, 100% 100%, 0% 100%)",
                  y: 0,
                  opacity: 1,
                  duration: 1,
                  scrollTrigger: {
                    trigger: item,
                    start: "200 center",
                    end: "bottom center",
                    // scrub: 3,
                  },
                }
              );
            }
          });
        },
      });
    });
  </script>
</Layout>
